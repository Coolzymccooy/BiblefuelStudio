import{c as k,f as G,r as t,j as e,B as c,b as i,z as a,I as Z}from"./index-BPh36Un5.js";import{C as n}from"./Card-DdOFDQ-A.js";import{I as v}from"./Input-DO4DbE3r.js";import{S as T}from"./sparkles-DhIwmh_C.js";import{L as B}from"./library-DavO46Sc.js";import{P as J}from"./play-Bj8DLsM9.js";import{D as W}from"./download-BJDkqYds.js";import{T as ee}from"./trash-2-8iKfmb3-.js";import{E as re}from"./external-link-vRiX1i35.js";const ae=[["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],se=k("bookmark",ae);const te=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],oe=k("folder-up",te);const le=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],N=k("search",le);function ue(){const{config:S}=G(),d=S.features.pexels,x=S.features.pixabay,[l,m]=t.useState("search"),[A,V]=t.useState("sunrise clouds"),[y,K]=t.useState([]),[I,M]=t.useState("space nebula"),[u,U]=t.useState([]),[L,P]=t.useState(!1),[b,C]=t.useState([]),[z,$]=t.useState(!1),[D,E]=t.useState(!1),[g,Y]=t.useState(""),[f,q]=t.useState([]),_=async()=>{if(!d){a.error("Pexels API is not configured");return}$(!0);try{const r=await i.get(`/api/pexels/search?q=${encodeURIComponent(A)}`);r.ok&&r.data?.videos?(K(r.data.videos),a.success(`Found ${r.data.videos.length} videos`)):a.error(r.error||"Search failed")}catch{a.error("An error occurred")}finally{$(!1)}},F=async()=>{if(!x){a.error("Pixabay API is not configured");return}P(!0);try{const r=await i.get(`/api/pixabay/search?q=${encodeURIComponent(I)}`);r.ok&&r.data?.videos?(U(r.data.videos),a.success(`Found ${r.data.videos.length} animated videos`)):a.error(r.error||"Search failed")}catch{a.error("An error occurred")}finally{P(!1)}},R=async()=>{E(!0);try{const r=await i.get("/api/library");r.ok&&r.data?.library?.items&&C(r.data.library.items)}catch(r){console.error("Failed to load library",r)}finally{E(!1)}};t.useEffect(()=>{l==="library"&&R()},[l]);const Q=async r=>{try{const s=await i.post("/api/library/add",r);s.ok?a.success("Saved to Library!"):a.error(s.error||"Failed to save")}catch{a.error("An error occurred")}},X=async r=>{try{const s=await i.delete(`/api/library/${r}`);s.ok?(C(j=>j.filter(o=>o.id!==r)),a.success("Removed from Library")):a.error(s.error||"Failed to remove")}catch{a.error("An error occurred")}},w=async r=>{if(!d){a.error("Pexels API is not configured");return}try{a.loading(`Downloading ${r}...`,{id:"download"});const s=await i.post("/api/pexels/download",{id:r});s.ok&&s.data?.file?a.success(`Downloaded to: ${s.data.file}`,{id:"download"}):a.error(s.error||"Download failed",{id:"download"})}catch{a.error("An error occurred",{id:"download"})}},H=async r=>{if(!x){a.error("Pixabay API is not configured");return}try{a.loading(`Downloading ${r}...`,{id:"download-animated"});const s=await i.post("/api/pixabay/download",{id:r});s.ok&&s.data?.file?a.success(`Downloaded to: ${s.data.file}`,{id:"download-animated"}):a.error(s.error||"Download failed",{id:"download-animated"})}catch{a.error("An error occurred",{id:"download-animated"})}},O=async()=>{if(!g.trim()){a.error("Enter a folder path");return}try{const r=await i.post("/api/library/import-local",{folderPath:g.trim()});r.ok&&r.data?.imported?(q(r.data.imported),a.success(`Imported ${r.data.imported.length} files`)):a.error(r.error||"Import failed")}catch{a.error("An error occurred")}},h=(r,s,j)=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(o=>e.jsx("div",{className:"group relative bg-white/[0.03] border border-white/10 rounded-2xl overflow-hidden hover:border-primary-500/50 transition-all duration-300",children:e.jsxs("div",{className:"aspect-[9/16] bg-black relative",children:[o.previewUrl?e.jsx("video",{src:o.previewUrl,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity",muted:!0,loop:!0,onMouseOver:p=>p.currentTarget.play(),onMouseOut:p=>{p.currentTarget.pause(),p.currentTarget.currentTime=0},poster:o.image}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:e.jsx(Z,{className:"text-gray-700",size:48})}),e.jsxs("div",{className:"absolute top-3 right-3 px-2 py-1 bg-black/60 backdrop-blur-md rounded-md text-[10px] font-bold text-white border border-white/10",children:[o.duration,"s"]}),e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-4 gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{onClick:()=>j(o.id),className:"flex-1 h-9 text-xs font-bold",children:[e.jsx(W,{size:14,className:"mr-2"}),"Download"]}),s?e.jsx(c,{onClick:()=>X(o.id),variant:"secondary",className:"h-9 px-3 bg-red-500/10 border-red-500/20 hover:bg-red-500/20 text-red-400",title:"Remove from Library",children:e.jsx(ee,{size:14})}):e.jsx(c,{onClick:()=>Q(o),variant:"secondary",className:"h-9 px-3 bg-white/10 border-white/10 hover:bg-white/20",title:"Save to Library",children:e.jsx(se,{size:14})})]}),e.jsxs("a",{href:o.url,target:"_blank",rel:"noreferrer",className:"w-full h-9 flex items-center justify-center bg-white/10 hover:bg-white/20 border border-white/10 text-white rounded-lg text-xs font-bold transition-all",children:[e.jsx(re,{size:14,className:"mr-2"}),"View Source"]})]})]})},o.id))});return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-primary-200",children:"Visual Backgrounds"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Search or browse your saved 4K/HD portrait videos."})]}),e.jsxs("div",{className:"flex flex-wrap bg-white/5 border border-white/10 p-1 rounded-xl",children:[e.jsxs("button",{onClick:()=>m("search"),disabled:!d,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-bold transition-all ${l==="search"?"bg-primary-500 text-white shadow-lg":"text-gray-400 hover:text-white"} ${d?"":"opacity-40 cursor-not-allowed"}`,children:[e.jsx(N,{size:14}),"Search"]}),e.jsxs("button",{onClick:()=>m("animated"),disabled:!x,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-bold transition-all ${l==="animated"?"bg-primary-500 text-white shadow-lg":"text-gray-400 hover:text-white"} ${x?"":"opacity-40 cursor-not-allowed"}`,children:[e.jsx(T,{size:14}),"Animated"]}),e.jsxs("button",{onClick:()=>m("local"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-bold transition-all ${l==="local"?"bg-primary-500 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[e.jsx(oe,{size:14}),"Local Packs"]}),e.jsxs("button",{onClick:()=>m("library"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-bold transition-all ${l==="library"?"bg-primary-500 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[e.jsx(B,{size:14}),"Library"]})]})]}),l==="search"?e.jsxs(e.Fragment,{children:[!d&&e.jsx(n,{className:"bg-yellow-500/10 border-yellow-500/20 text-yellow-200 text-xs",children:"Pexels is disabled. Set `PEXELS_API_KEY` in `server/.env`."}),e.jsx(n,{className:"bg-white/5 border-white/10 backdrop-blur-xl",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",size:18}),e.jsx(v,{value:A,onChange:r=>V(r.target.value),placeholder:"e.g. moody bible, storm clouds, peaceful nature...",onKeyDown:r=>r.key==="Enter"&&_(),className:"pl-10 bg-black/20 border-white/10"})]}),e.jsx(c,{onClick:_,isLoading:z,className:"px-8",children:"Search"})]})}),y.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between px-2",children:e.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-500",children:["Results (",y.length,")"]})}),h(y,!1,w)]}):!z&&e.jsxs("div",{className:"py-20 flex flex-col items-center justify-center opacity-30",children:[e.jsx(J,{size:64,className:"text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Search for portrait videos to see results."})]})]}):l==="animated"?e.jsxs(e.Fragment,{children:[!x&&e.jsx(n,{className:"bg-yellow-500/10 border-yellow-500/20 text-yellow-200 text-xs",children:"Pixabay is disabled. Set `PIXABAY_API_KEY` in `server/.env`."}),e.jsx(n,{className:"bg-white/5 border-white/10 backdrop-blur-xl",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",size:18}),e.jsx(v,{value:I,onChange:r=>M(r.target.value),placeholder:"e.g. space, nebula, galaxy, abstract...",onKeyDown:r=>r.key==="Enter"&&F(),className:"pl-10 bg-black/20 border-white/10"})]}),e.jsx(c,{onClick:F,isLoading:L,className:"px-8",children:"Search"})]})}),u.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between px-2",children:e.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-500",children:["Animated Results (",u.length,")"]})}),h(u,!1,H),e.jsx("div",{className:"text-xs text-gray-500 px-2",children:"Downloads use Pixabay. Make sure `PIXABAY_API_KEY` is set in `server/.env`."})]}):!L&&e.jsxs("div",{className:"py-20 flex flex-col items-center justify-center opacity-30",children:[e.jsx(T,{size:64,className:"text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Search for animated backgrounds to see results."})]})]}):l==="local"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(n,{className:"bg-white/5 border-white/10 backdrop-blur-xl",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{value:g,onChange:r=>Y(r.target.value),placeholder:"e.g. C:\\\\videos\\\\studio-packs",className:"bg-black/20 border-white/10"}),e.jsx(c,{onClick:O,className:"px-6",children:"Import Folder"})]}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:"Imports .mp4/.mov/.webm/.m4v from the folder into the library and outputs."})]}),f.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-500",children:["Imported (",f.length,")"]}),h(f,!0,w)]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-500",children:["Saved Library (",b.length,")"]}),e.jsx(c,{onClick:R,variant:"secondary",className:"h-8 text-[10px] uppercase tracking-tighter",disabled:D,children:"Refresh"})]}),b.length>0?h(b,!0,w):!D&&e.jsxs(n,{className:"py-20 flex flex-col items-center justify-center opacity-30 border-dashed",children:[e.jsx(B,{size:64,className:"text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400 font-bold uppercase tracking-widest text-xs",children:"Library is empty"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:"Save videos from search to build your library."})]})]})]})}export{ue as BackgroundsPage};
