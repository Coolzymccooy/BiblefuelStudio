import{d as G,h as P,r as l,j as e,B as n,M as _,b as u,z as a}from"./index-2zSl8dPB.js";import{C as g}from"./Card-BZBWq0kh.js";import{I as f}from"./Input-BZbQ3akf.js";import{S as T}from"./Select-cWS8Fylg.js";import{l as $,S as o,s as j}from"./storage-DAnXyH0z.js";import{P as z}from"./plus-D5u4DWYv.js";function R(){const p=G(),{config:v}=P(),i=v.features.scripts,[d,y]=l.useState(10),[m,N]=l.useState("save"),[x,b]=l.useState(20),[r,c]=l.useState([]),[S,h]=l.useState(!1);l.useEffect(()=>{const s=$(o.scripts,[]);s.length&&c(s)},[]);const C=async()=>{h(!0);try{const s=await u.post("/api/scripts/generate",{count:d,ctaStyle:m,lengthSeconds:x});s.ok&&s.data?.scripts?(c(s.data.scripts),j(o.scripts,s.data.scripts),a.success(`Generated ${s.data.scripts.length} scripts!`)):a.error(s.error||"Failed to generate scripts")}catch{a.error("An error occurred")}finally{h(!1)}},k=async s=>{try{const t=await u.post("/api/queue/add",{title:s.title||"Biblefuel Post",hook:s.hook||"",verse:s.verse||"",reference:s.reference||"",reflection:s.reflection||"",cta:s.cta||"",hashtags:s.hashtags||[]});t.ok?a.success("Added to queue!"):a.error(t.error||"Failed to add to queue")}catch{a.error("An error occurred")}},w=s=>{const t=`${s.hook}

${s.verse} (${s.reference})

${s.reflection}

${s.cta}`;localStorage.setItem("bf_tts_text",t),a.success("Script sent to Voice page!"),p("/voice-audio")},A=()=>{c([]),j(o.scripts,[])};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Generate Scripts"}),e.jsxs(g,{title:"Configuration",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Count"}),e.jsx(f,{type:"number",value:d,onChange:s=>y(Number(s.target.value)),min:1,max:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CTA Style"}),e.jsxs(T,{value:m,onChange:s=>N(s.target.value),children:[e.jsx("option",{value:"save",children:"save"}),e.jsx("option",{value:"follow",children:"follow"}),e.jsx("option",{value:"share",children:"share"}),e.jsx("option",{value:"comment",children:"comment"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Length (seconds)"}),e.jsx(f,{type:"number",value:x,onChange:s=>b(Number(s.target.value)),min:8,max:90})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(n,{onClick:C,isLoading:S,disabled:!i,className:"w-full sm:w-auto",children:"Generate"}),e.jsx(n,{onClick:A,variant:"secondary",disabled:r.length===0,className:"w-full sm:w-auto",children:"Clear"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:i?"If you didn't set keys, fallback scripts will be used.":"Scripts are disabled until OPENAI_API_KEY or GEMINI_API_KEY is configured."})]}),r.length>0&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Generated Scripts (",r.length,")"]}),r.map((s,t)=>e.jsx(g,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("h4",{className:"font-bold text-lg",children:[t+1,". ",s.title]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Hook:"}),e.jsx("p",{className:"text-gray-800",children:s.hook})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Verse:"}),e.jsxs("p",{className:"text-gray-800",children:[s.verse," ",e.jsx("span",{className:"text-gray-500 text-sm italic",children:s.reference})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Reflection:"}),e.jsx("p",{className:"text-gray-800",children:s.reflection})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"CTA:"}),e.jsx("p",{className:"text-gray-800",children:s.cta})]}),s.hashtags&&s.hashtags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.hashtags.slice(0,10).map((E,I)=>e.jsx("span",{className:"inline-block px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:E},I))}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsxs(n,{onClick:()=>k(s),children:[e.jsx(z,{size:16,className:"mr-2"}),"Add to Queue"]}),e.jsxs(n,{onClick:()=>w(s),variant:"secondary",children:[e.jsx(_,{size:16,className:"mr-2"}),"Send to Voice"]})]})]})},t))]})]})}export{R as ScriptsPage};
