import{c as T,h as L,r as u,j as e,B as l,b as y,z as x}from"./index-CfOaS_bp.js";import{C as I}from"./Card-0Ip1zazd.js";import{B as A}from"./Badge-DZHWqAuq.js";import{I as r}from"./Input-oNwcFpDp.js";import{S as p}from"./Select-DSklM6me.js";import{R as q}from"./refresh-cw-Dh0i9_X3.js";const O=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],F=T("key",O);const $=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],S=T("link-2",$);const V=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],G=T("triangle-alert",V);function ae(){const{config:w}=L(),{features:m}=w,[g,N]=u.useState("api"),[b,U]=u.useState(""),[P,z]=u.useState([]),[f,E]=u.useState([]),[c,v]=u.useState([]),[B,_]=u.useState(""),[C,k]=u.useState([]),[t,h]=u.useState({youtubeClientId:"",youtubeClientSecret:"",youtubeRefreshToken:"",instagramAccessToken:"",instagramUserId:"",tiktokAccessToken:"",tiktokOpenId:""}),K=u.useMemo(()=>[{name:"OPENAI_API_KEY",label:"OpenAI API Key",desc:"Required for Scripts",enabled:m.scripts},{name:"GEMINI_API_KEY",label:"Gemini API Key",desc:"Alternative for Scripts",enabled:m.scripts},{name:"ELEVENLABS_API_KEY",label:"ElevenLabs API Key",desc:"Required for TTS Voice",enabled:m.tts},{name:"PEXELS_API_KEY",label:"Pexels API Key",desc:"Required for Background Videos",enabled:m.pexels},{name:"PIXABAY_API_KEY",label:"Pixabay API Key",desc:"Required for Animated Backgrounds",enabled:m.pixabay},{name:"FFMPEG_PATH",label:"FFmpeg",desc:"Required for Render + Audio Processing",enabled:m.render}],[m]),R=async()=>{const a=await y.get("/api/social/config");if(a.ok&&a.data){E(a.data.buffer?.profileIds||[]);const s=(a.data.webhooks||[]).map(n=>({...n}));v(s),k((a.data.schedules||[]).map(n=>({id:String(n.id||`sch_${Date.now()}`),name:String(n.name||"Scheduled Post"),enabled:!!(n.enabled??!0),cron:String(n.cron||""),timezone:String(n.timezone||"UTC"),destination:["webhook","buffer","youtube"].includes(String(n.destination))?String(n.destination):"webhook",caption:String(n.caption||""),videoUrl:String(n.videoUrl||""),webhookId:String(n.webhookId||""),profileId:String(n.profileId||""),privacyStatus:["private","unlisted","public"].includes(String(n.privacyStatus))?String(n.privacyStatus):"private"})));const o=s.find(n=>n.enabled),i=o?.id||o?.url||s[0]?.id||s[0]?.url||"";_(i),a.data.direct&&h({youtubeClientId:a.data.direct.youtube?.clientId||"",youtubeClientSecret:a.data.direct.youtube?.clientSecret||"",youtubeRefreshToken:a.data.direct.youtube?.refreshToken||"",instagramAccessToken:a.data.direct.instagram?.accessToken||"",instagramUserId:a.data.direct.instagram?.userId||"",tiktokAccessToken:a.data.direct.tiktok?.accessToken||"",tiktokOpenId:a.data.direct.tiktok?.openId||""})}};u.useEffect(()=>{R()},[]);const j=async()=>{const a=await y.post("/api/social/config",{buffer:{accessToken:b||void 0,profileIds:f},webhooks:c,schedules:C,direct:{youtube:{clientId:t.youtubeClientId,clientSecret:t.youtubeClientSecret,refreshToken:t.youtubeRefreshToken},instagram:{accessToken:t.instagramAccessToken,userId:t.instagramUserId},tiktok:{accessToken:t.tiktokAccessToken,openId:t.tiktokOpenId}}});a.ok?(x.success("Social config saved"),await R()):x.error(a.error||"Failed to save social config")},Y=()=>{const a={id:`sch_${Date.now()}_${Math.random().toString(36).slice(2,6)}`,name:"Auto Post",enabled:!0,cron:"0 */1 * * *",timezone:"UTC",destination:"webhook",caption:"",videoUrl:"",webhookId:c[0]?.id||"",profileId:f[0]||"",privacyStatus:"private"};k(s=>[a,...s])},d=(a,s)=>{k(o=>o.map(i=>i.id===a?{...i,...s}:i))},D=a=>{k(s=>s.filter(o=>o.id!==a))},M=async()=>{if(!b){x.error("Add Buffer access token first");return}const a=await y.post("/api/social/buffer/profiles",{accessToken:b});a.ok&&a.data?.profiles?(z(a.data.profiles),x.success("Buffer profiles loaded")):x.error(a.error||"Failed to load profiles")},W=async()=>{const a=c.find((o,i)=>(o.id||o.url||String(i))===B);if(!a?.url){x.error("Select a webhook first");return}const s=await y.post("/api/social/post",{destination:"webhook",webhookId:a.id,webhookUrl:a.url,caption:"Test post from Biblefuel Studio",videoUrl:"https://example.com/test-video.mp4",meta:{event:"test.webhook",source:"settings"}});s.ok?x.success("Test webhook sent"):x.error(s.error||"Failed to send test webhook")};return e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400 mb-2",children:"Settings"}),e.jsx("p",{className:"text-gray-400",children:"Manage keys, social automation, and app info."})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(l,{variant:g==="api"?"primary":"secondary",className:"text-xs h-8",onClick:()=>N("api"),children:"API Keys"}),e.jsx(l,{variant:g==="social"?"primary":"secondary",className:"text-xs h-8",onClick:()=>N("social"),children:"Social Automation"}),e.jsx(l,{variant:g==="app"?"primary":"secondary",className:"text-xs h-8",onClick:()=>N("app"),children:"App Info"})]}),g==="api"&&e.jsx(I,{title:"API Configuration",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3 flex items-start gap-3",children:[e.jsx(G,{className:"text-blue-400 shrink-0 mt-1",size:18}),e.jsxs("div",{className:"text-xs text-blue-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Environment Variables"}),e.jsxs("p",{children:["Set keys in ",e.jsx("code",{className:"bg-black/30 px-1.5 py-0.5 rounded text-blue-300",children:"server/.env"})," and restart."]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:K.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-xl border border-white/5 hover:border-white/10 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-dark-900 rounded-lg text-gray-400",children:e.jsx(F,{size:16})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 text-sm",children:a.label}),e.jsx("p",{className:"text-[10px] text-gray-500",children:a.desc})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"hidden sm:block text-[10px] text-gray-600 bg-black/20 px-2 py-1 rounded",children:a.name}),e.jsx(A,{variant:a.enabled?"success":"warning",children:a.enabled?"Ready":"Missing"})]})]},a.name))})]})}),g==="social"&&e.jsx(I,{title:"Social Automation",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Use Buffer or webhooks for the fastest setup. Direct APIs require OAuth apps and approvals."}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-300",children:[e.jsx(S,{size:14})," Buffer (Legacy API)"]}),e.jsx(r,{value:b,onChange:a=>U(a.target.value),placeholder:"Buffer access token"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(l,{variant:"secondary",className:"text-xs h-8",onClick:M,children:[e.jsx(q,{size:14,className:"mr-2"}),"Load Profiles"]}),e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:j,children:"Save Config"})]}),P.length>0&&e.jsxs(p,{value:f[0]||"",onChange:a=>E([a.target.value]),children:[e.jsx("option",{value:"",children:"Select profile..."}),P.map(a=>e.jsxs("option",{value:a.id,children:[a.formatted_service," (",a.id,")"]},a.id))]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-300",children:[e.jsx(S,{size:14})," Webhooks (Zapier/Make)"]}),e.jsxs(p,{value:B,onChange:a=>_(a.target.value),children:[e.jsx("option",{value:"",children:"Select webhook to test..."}),c.map((a,s)=>e.jsxs("option",{value:a.id||a.url||String(s),children:[a.name||`Webhook ${s+1}`,a.enabled?"":" (disabled)"]},a.id||a.url||s))]}),c.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx(r,{value:a.name,onChange:o=>{const i=[...c];i[s]={...i[s],name:o.target.value},v(i)},placeholder:"Webhook name"}),e.jsx(r,{value:a.url,onChange:o=>{const i=[...c];i[s]={...i[s],url:o.target.value},v(i)},placeholder:"https://hooks.zapier.com/..."}),e.jsxs(p,{value:a.enabled?"true":"false",onChange:o=>{const i=[...c];i[s]={...i[s],enabled:o.target.value==="true"},v(i)},children:[e.jsx("option",{value:"true",children:"Enabled"}),e.jsx("option",{value:"false",children:"Disabled"})]})]},a.id||s)),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:()=>v([...c,{name:"Zapier",url:"",enabled:!0}]),children:"Add Webhook"}),e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:W,children:"Send Test Webhook"}),e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:j,children:"Save Config"})]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-300 mb-2",children:[e.jsx(S,{size:14})," Direct APIs (Beta)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx(r,{value:t.youtubeClientId,onChange:a=>h({...t,youtubeClientId:a.target.value}),placeholder:"YouTube Client ID"}),e.jsx(r,{value:t.youtubeClientSecret,onChange:a=>h({...t,youtubeClientSecret:a.target.value}),placeholder:"YouTube Client Secret"}),e.jsx(r,{value:t.youtubeRefreshToken,onChange:a=>h({...t,youtubeRefreshToken:a.target.value}),placeholder:"YouTube Refresh Token"}),e.jsx(r,{value:t.instagramAccessToken,onChange:a=>h({...t,instagramAccessToken:a.target.value}),placeholder:"Instagram Access Token"}),e.jsx(r,{value:t.instagramUserId,onChange:a=>h({...t,instagramUserId:a.target.value}),placeholder:"Instagram User ID"}),e.jsx(r,{value:t.tiktokAccessToken,onChange:a=>h({...t,tiktokAccessToken:a.target.value}),placeholder:"TikTok Access Token"}),e.jsx(r,{value:t.tiktokOpenId,onChange:a=>h({...t,tiktokOpenId:a.target.value}),placeholder:"TikTok Open ID"})]}),e.jsx("div",{className:"flex gap-2 mt-2",children:e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:j,children:"Save Direct Config"})})]}),e.jsxs("div",{className:"pt-2 border-t border-white/10 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-300",children:[e.jsx(S,{size:14})," Auto Post Schedules (Cron)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:Y,children:"Add Schedule"}),e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:j,children:"Save Schedules"})]})]}),e.jsxs("p",{className:"text-[10px] text-gray-500",children:["Cron format: ",e.jsx("code",{children:"m h dom mon dow"}),". Example: ",e.jsx("code",{children:"0 */2 * * *"})," runs every 2 hours."]}),C.length===0&&e.jsx("div",{className:"text-xs text-gray-500",children:"No schedules yet."}),C.map(a=>e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/[0.03] p-3 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2",children:[e.jsx(r,{value:a.name,onChange:s=>d(a.id,{name:s.target.value}),placeholder:"Schedule name"}),e.jsx(r,{value:a.cron,onChange:s=>d(a.id,{cron:s.target.value}),placeholder:"0 */1 * * *"}),e.jsx(r,{value:a.timezone,onChange:s=>d(a.id,{timezone:s.target.value}),placeholder:"UTC"}),e.jsxs(p,{value:a.enabled?"true":"false",onChange:s=>d(a.id,{enabled:s.target.value==="true"}),children:[e.jsx("option",{value:"true",children:"Enabled"}),e.jsx("option",{value:"false",children:"Disabled"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsxs(p,{value:a.destination,onChange:s=>d(a.id,{destination:s.target.value}),children:[e.jsx("option",{value:"webhook",children:"Webhook"}),e.jsx("option",{value:"buffer",children:"Buffer"}),e.jsx("option",{value:"youtube",children:"YouTube"})]}),a.destination==="webhook"&&e.jsxs(p,{value:a.webhookId||"",onChange:s=>d(a.id,{webhookId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select webhook..."}),c.map((s,o)=>e.jsx("option",{value:s.id||"",children:s.name||`Webhook ${o+1}`},s.id||o))]}),a.destination==="buffer"&&e.jsxs(p,{value:a.profileId||"",onChange:s=>d(a.id,{profileId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select profile..."}),f.map(s=>e.jsx("option",{value:s,children:s},s))]}),a.destination==="youtube"&&e.jsxs(p,{value:a.privacyStatus||"private",onChange:s=>d(a.id,{privacyStatus:s.target.value}),children:[e.jsx("option",{value:"private",children:"YouTube Private"}),e.jsx("option",{value:"unlisted",children:"YouTube Unlisted"}),e.jsx("option",{value:"public",children:"YouTube Public"})]}),e.jsx(l,{variant:"secondary",className:"text-xs h-10",onClick:()=>D(a.id),children:"Remove"})]}),e.jsx(r,{value:a.videoUrl,onChange:s=>d(a.id,{videoUrl:s.target.value}),placeholder:"Video URL or /outputs/video-xxx.mp4"}),e.jsx(r,{value:a.caption,onChange:s=>d(a.id,{caption:s.target.value}),placeholder:"Caption for scheduled post"})]},a.id))]})]})}),g==="app"&&e.jsx(I,{title:"Application Info",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-white/5",children:[e.jsx("span",{className:"text-gray-400",children:"Version"}),e.jsx("span",{className:"font-mono text-sm",children:"v3.0.0 (React Refactor)"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-white/5",children:[e.jsx("span",{className:"text-gray-400",children:"Environment"}),e.jsx(A,{variant:"success",children:w.env})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-white/5",children:[e.jsx("span",{className:"text-gray-400",children:"Backend Status"}),e.jsx(A,{variant:"success",children:"Connected"})]})]})})]})}export{ae as SettingsPage};
