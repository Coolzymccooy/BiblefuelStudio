import{c as K,f as et,r as a,z as i,b,j as e,B as l,W as st,M as tt}from"./index-CxYgDQXy.js";import{C as S}from"./Card-vEHJlAFj.js";import{I as n}from"./Input-BbJpD39E.js";import{T as ds}from"./Textarea-g3ERAsS5.js";import{S as xe}from"./Select-Bhl8QH8o.js";import{l as w,s as k,t as he,S as u,p as at}from"./storage-Be9O-pzO.js";import{R as rt}from"./refresh-cw-qsLqLNle.js";import{P as it}from"./plus-vkiWdBPP.js";import{T as ot}from"./trash-2-BtcKsccB.js";import{P as ct}from"./play-qVgS35P6.js";import{M as nt}from"./music-DqoO7XAC.js";const lt=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],us=K("chevron-down",lt);const dt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ms=K("chevron-up",dt);const ut=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],pe=K("clipboard",ut);const mt=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],xt=K("upload",mt),y={clean_voice:{denoise:.45,gate:-38,highpass:80,lowpass:12e3,compRatio:3,compThreshold:-18,lufs:-16,removeSilence:!1},podcast:{denoise:.35,gate:-40,highpass:70,lowpass:14e3,compRatio:4,compThreshold:-20,lufs:-14,removeSilence:!1},warm:{denoise:.3,gate:-42,highpass:70,lowpass:1e4,compRatio:2.6,compThreshold:-19,lufs:-16,removeSilence:!1},raw:{denoise:0,gate:-70,highpass:0,lowpass:2e4,compRatio:1,compThreshold:-40,lufs:-16,removeSilence:!1}};function kt(){const{config:xs}=et(),E=xs.features.tts,[z,_]=a.useState(""),[h,I]=a.useState(""),[U,hs]=a.useState("clean_voice"),[D,ge]=a.useState([]),[fe,G]=a.useState(!1),[ps,ve]=a.useState(!1),[ye,Q]=a.useState(!1),[je,gs]=a.useState(!0),[be,fs]=a.useState(!1),[M,vs]=a.useState(!1),[Ne,J]=a.useState(""),[H,$]=a.useState(""),[L,X]=a.useState(.5),[V,Z]=a.useState(.75),[C,B]=a.useState([]),[Se,we]=a.useState(""),[ke,Ce]=a.useState(""),[Re,Pe]=a.useState(.5),[Ae,Te]=a.useState(.75),[Ie,Le]=a.useState(""),[Ve,ys]=a.useState([]),[js,Ee]=a.useState(!1),[bs,ze]=a.useState(!1),[ee,Ns]=a.useState(""),[_e,Ss]=a.useState(""),[W,se]=a.useState(""),[te,ws]=a.useState(!1),[ae,ks]=a.useState(!1),[re,Cs]=a.useState(!1),[d,Rs]=a.useState("all"),[ie,Ps]=a.useState([]),[As,Ue]=a.useState(!1),p=a.useRef(null),F=a.useRef(null),R=a.useRef([]),De=a.useRef(null),P=a.useRef(null),oe=a.useRef(null),A=a.useRef(null),T=a.useRef(null);a.useEffect(()=>{const s=w(u.ttsText,"");s&&_(s);const t=localStorage.getItem("bf_tts_text");t&&(_(t),localStorage.removeItem("bf_tts_text"),i.success("Script loaded from automation!"));const r=w(u.audioPath,"");r&&I(r);const o=w(u.audioHistory,[]);o.length&&ge(o.map(j=>({...j,createdAt:j.createdAt||new Date().toISOString()})));const c=w(u.ttsVoiceId,"");c&&$(c);const m=w(u.ttsStability,.5);X(m);const x=w(u.ttsSimilarity,.75);Z(x);const g=w(u.ttsVoicePresets,[]);if(g.length)B(g);else{const j=[{id:"narrator",label:"Narrator",voiceId:"",stability:.6,similarity:.75,tags:["pack"]},{id:"sermon",label:"Sermon",voiceId:"",stability:.55,similarity:.8,tags:["pack"]},{id:"youth",label:"Youth",voiceId:"",stability:.35,similarity:.65,tags:["pack"]}];B(j),k(u.ttsVoicePresets,j)}},[]),a.useEffect(()=>{k(u.ttsText,z)},[z]),a.useEffect(()=>{k(u.audioPath,h)},[h]),a.useEffect(()=>{k(u.ttsVoiceId,H)},[H]),a.useEffect(()=>{k(u.ttsStability,L)},[L]),a.useEffect(()=>{k(u.ttsSimilarity,V)},[V]),a.useEffect(()=>{C.length&&k(u.ttsVoicePresets,C)},[C]),a.useEffect(()=>{!W&&h&&se(h)},[h,W]);const ce=(s,t,r)=>{const o={id:s,path:s,kind:t,label:r,createdAt:new Date().toISOString()},c=at(u.audioHistory,o,m=>m.id,30);ge(c)},Ts=async()=>{if(!z.trim()){i.error("Enter some text first");return}G(!0);try{const s=await b.post("/api/tts/elevenlabs",{text:z,voiceId:H||void 0,voiceSettings:{stability:L,similarity_boost:V}});s.ok&&s.data?.file?(I(s.data.file),ce(s.data.file,"tts","ElevenLabs"),i.success("MP3 generated!")):i.error(s.error||"TTS generation failed")}catch{i.error("An error occurred")}finally{G(!1)}},Is=async()=>{if(!h.trim()){i.error("Audio Path is empty");return}G(!0);try{const s={inputPath:h,preset:U};U!=="raw"&&(s.denoise={strength:Be},s.gate={thresholdDb:qe},s.eq={highpassHz:Qe,lowpassHz:Oe},s.compressor={ratio:Ke,thresholdDb:Xe,attackMs:12,releaseMs:150},s.normalize={targetLUFS:es},s.silenceRemove={enabled:ts}),M&&le>0&&(s.deesser={amount:le}),M&&de<0&&(s.limiter={ceilingDb:de}),M&&ue!==0&&(s.presence={freqHz:rs,gainDb:ue,widthQ:is});const t=await b.post("/api/audio/process",s);t.ok&&t.data?.file?(I(t.data.file),ce(t.data.file,"processed","Processed"),i.success("Audio processed!")):i.error(t.error||"Processing failed")}catch{i.error("An error occurred")}finally{G(!1)}},Me=async(s,t,r)=>{ve(!0);try{const o=await b.post("/api/media/upload-audio",{dataUrl:s,filename:t});if(o.ok&&o.data?.file)return I(o.data.file),ce(o.data.file,r,t),i.success("Audio uploaded!"),{ok:!0,file:o.data.file};{const c=o.error||"Upload failed";return i.error(c),{ok:!1,error:c}}}catch(o){const c=o instanceof Error?o.message:"An error occurred";return i.error(c),{ok:!1,error:c}}finally{ve(!1)}},Ls=async s=>{const t=new FileReader;t.onload=async()=>{const r=String(t.result||"");if(!r.startsWith("data:audio/")){i.error("Please select an audio file");return}await Me(r,s.name||"upload.webm","upload")},t.readAsDataURL(s)},Vs=async s=>{const t=De.current;if(!t)return;const r=t.getBoundingClientRect(),o=window.devicePixelRatio||1,c=Math.max(520,Math.floor((r.width||520)*o)),m=Math.max(80,Math.floor(96*o));t.width!==c&&(t.width=c),t.height!==m&&(t.height=m);const x=new(window.AudioContext||window.webkitAudioContext);x.state==="suspended"&&await x.resume();const g=x.createAnalyser();g.fftSize=1024,g.smoothingTimeConstant=.85;const j=x.createMediaStreamSource(s);j.connect(g),P.current=x,oe.current=g,A.current=j;const f=g.frequencyBinCount,q=new Uint8Array(f),v=t.getContext("2d");if(!v)return;const os=()=>{T.current=requestAnimationFrame(os),g.getByteTimeDomainData(q),v.clearRect(0,0,t.width,t.height),v.fillStyle="rgba(15, 23, 42, 0.8)",v.fillRect(0,0,t.width,t.height);let cs=0;for(let N=0;N<f;N++){const Y=(q[N]-128)/128;cs+=Y*Y}const ns=Math.sqrt(cs/f),Xs=Math.min(4,Math.max(1,1.5+ns*8));v.lineWidth=2.2,v.strokeStyle=ns>.02?"#38bdf8":"#0ea5e9",v.beginPath();const Zs=t.width/f;let me=0;for(let N=0;N<f;N++){const Y=(q[N]-128)/128*Xs,ls=t.height/2+Y*(t.height*.32);N===0?v.moveTo(me,ls):v.lineTo(me,ls),me+=Zs}v.lineTo(t.width,t.height/2),v.stroke()};os()},He=()=>{T.current&&cancelAnimationFrame(T.current),T.current=null,oe.current=null,A.current&&(A.current.disconnect(),A.current=null),P.current&&(P.current.close(),P.current=null)},ne=()=>{if(p.current&&p.current.state!=="inactive")try{p.current.stop()}catch{}p.current=null,F.current?.getTracks().forEach(s=>s.stop()),F.current=null,R.current=[],He(),Q(!1)},Es=()=>{const s=["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/ogg"];for(const t of s)if(MediaRecorder.isTypeSupported(t))return t;return""},zs=async s=>{if(!s||s.size===0)throw new Error("Empty audio blob");const t=new FileReader,r=await new Promise((f,q)=>{t.onerror=()=>q(new Error("Failed to read audio blob")),t.onload=()=>f(String(t.result||"")),t.readAsDataURL(s)});if(r&&r.startsWith("data:")&&r.includes(","))return r;const o=await s.arrayBuffer(),c=new Uint8Array(o);let m="";for(let f=0;f<c.length;f++)m+=String.fromCharCode(c[f]);const x=btoa(m);return`data:${(s.type||"audio/webm").split(";")[0]||"audio/webm"};base64,${x}`},_s=async()=>{if(!(ye||p.current&&p.current.state==="recording"))try{const s=await navigator.mediaDevices.getUserMedia({audio:!0});F.current=s;const t=Es(),r=new MediaRecorder(s,t?{mimeType:t}:void 0);J(""),R.current=[],r.ondataavailable=o=>{o.data.size>0&&R.current.push(o.data)},r.onstop=async()=>{Q(!1);const o=r.mimeType||t||"audio/webm";if(R.current.length===0){i.error("No audio captured"),J("No chunks captured from MediaRecorder."),ne();return}const c=new Blob(R.current,{type:o});J(`Captured ${R.current.length} chunk(s), ${c.size} bytes, mime=${o}`);try{const m=await zs(c),x=o.includes("ogg")?"ogg":o.includes("wav")?"wav":o.includes("mp4")?"m4a":"webm";if(!(await Me(m,`recording-${Date.now()}.${x}`,"record")).ok)return}catch(m){const x=m instanceof Error?m.message:"Recording upload failed";i.error(x)}finally{ne()}},p.current=r,r.start(250),await Vs(s),Q(!0),i.success("Recording started")}catch(s){ne();const t=s instanceof Error?s.message:"Microphone access denied";i.error(t)}},Us=()=>{const s=p.current;s&&(s.state==="recording"&&s.stop(),He(),Q(!1))},Ds=()=>{const t=w(u.scripts,[])[0];if(!t){i.error("No scripts found. Generate scripts first.");return}const r=`${t.hook}

${t.verse} (${t.reference})

${t.reflection}

${t.cta}`;_(r),i.success("Latest script loaded")},Ms=()=>{_(`Hook line here...

Verse (Reference)

Short reflection/prayer...

CTA (e.g. Save this + follow for more)`)},Hs=s=>{$(s.voiceId||""),X(s.stability),Z(s.similarity),i.success(`Applied preset: ${s.label}`)},$s=()=>{const s=Se.trim();if(!s){i.error("Preset label is required");return}const r=[{id:`vp_${Date.now()}`,label:s,voiceId:ke.trim(),stability:Re,similarity:Ae},...C];B(r),we(""),Ce(""),Pe(.5),Te(.75),i.success("Preset saved")},Bs=s=>{B(C.filter(t=>t.id!==s))},Fs=()=>{const s=Ie.split(/\r?\n|,/).map(r=>r.trim()).filter(Boolean);if(s.length===0)return;const t=[...C];s.forEach((r,o)=>{const c=r.includes("|")?r.split("|"):r.split(":"),m=c.length>1?c[0].trim():`Voice ${o+1}`,x=c.length>1?c[1].trim():r;x&&t.unshift({id:`vp_${Date.now()}_${o}`,label:m,voiceId:x,stability:L,similarity:V})}),B(t),Le(""),i.success("Voice IDs added")},$e=async()=>{Ee(!0);try{const s=await b.get("/api/tts/voices");s.ok&&s.data?.voices?(ys(s.data.voices),i.success("Voices loaded")):i.error(s.error||"Failed to load voices")}finally{Ee(!1)}},qs=async()=>{if(!E){i.error("TTS is disabled. Add ELEVENLABS_API_KEY first.");return}if(!ee.trim()){i.error("Enter a clone voice name");return}const s=(W||h||"").trim();if(!s){i.error("Provide a sample audio path for cloning");return}if(!te||!ae||!re){i.error("All consent checkboxes are required");return}ze(!0);try{const t=await b.post("/api/tts/clone-voice",{name:ee.trim(),description:_e.trim()||void 0,samplePaths:[s],removeBackgroundNoise:!0,consent:{hasRights:te,noImpersonation:ae,termsAccepted:re}});if(t.ok&&(t.data?.voiceId||t.data?.voice?.voice_id)){const r=String(t.data.voiceId||t.data.voice?.voice_id||"").trim();r&&$(r),i.success("Voice cloned successfully"),await $e()}else{const r=t.error||"Voice clone failed";r.includes("create_instant_voice_clone")?i.error("API key missing Instant Voice Clone permission. Update key scope in ElevenLabs Developers > API Keys."):i.error(r)}}catch(t){const r=t instanceof Error?t.message:"Voice clone failed";i.error(r)}finally{ze(!1)}},Gs=async()=>{Ue(!0);try{const s=await b.get("/api/media/audio-list");s.ok&&s.data?.items?(Ps(s.data.items),i.success("Music library loaded")):i.error(s.error||"Failed to load music library")}finally{Ue(!1)}},Qs=s=>{s&&(k(u.renderMusicPath,s),i.success("Soundtrack set for Render"))},O=he(h,b.baseUrl),[Be,Fe]=a.useState(y.clean_voice.denoise),[qe,Ge]=a.useState(y.clean_voice.gate),[Qe,We]=a.useState(y.clean_voice.highpass),[Oe,Ye]=a.useState(y.clean_voice.lowpass),[Ke,Je]=a.useState(y.clean_voice.compRatio),[Xe,Ze]=a.useState(y.clean_voice.compThreshold),[es,ss]=a.useState(y.clean_voice.lufs),[ts,as]=a.useState(y.clean_voice.removeSilence),[le,Ws]=a.useState(0),[de,Os]=a.useState(-1),[ue,Ys]=a.useState(0),[rs,Ks]=a.useState(4e3),[is,Js]=a.useState(1);return a.useEffect(()=>{const s=y[U]||y.clean_voice;Fe(s.denoise),Ge(s.gate),We(s.highpass),Ye(s.lowpass),Je(s.compRatio),Ze(s.compThreshold),ss(s.lufs),as(s.removeSilence)},[U]),a.useEffect(()=>()=>{if(p.current&&p.current.state!=="inactive")try{p.current.stop()}catch{}p.current=null,F.current?.getTracks().forEach(s=>s.stop()),F.current=null,R.current=[],T.current&&cancelAnimationFrame(T.current),T.current=null,oe.current=null,A.current&&(A.current.disconnect(),A.current=null),P.current&&(P.current.close(),P.current=null)},[]),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Voice & Audio"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"all",label:"All"},{id:"voice",label:"Voice"},{id:"record",label:"Record/Upload"},{id:"treatment",label:"Audio Treatment"},{id:"soundtrack",label:"Soundtrack"}].map(s=>e.jsx(l,{variant:d===s.id?"primary":"secondary",className:"text-xs h-8",onClick:()=>Rs(s.id),children:s.label},s.id))}),(d==="all"||d==="voice")&&e.jsx(S,{title:"1. TTS (ElevenLabs)",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Text for voice"}),e.jsx(ds,{value:z,onChange:s=>_(s.target.value),placeholder:"Paste hook + verse + reflection",className:"min-h-[180px]"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsxs(l,{onClick:Ds,variant:"secondary",className:"text-xs h-8",children:[e.jsx(st,{size:14,className:"mr-2"}),"Use Latest Script"]}),e.jsxs(l,{onClick:Ms,variant:"secondary",className:"text-xs h-8",children:[e.jsx(pe,{size:14,className:"mr-2"}),"Insert Template"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"You can paste any text here: hook, verse, short reflection/prayer, and CTA. Keep it under about 6 short lines for best captions."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Voice ID (optional)"}),e.jsx(n,{value:H,onChange:s=>$(s.target.value),placeholder:"Leave empty to use default voice"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Paste a voice ID or load your voices below."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Stability (",L,")"]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:L,onChange:s=>X(Number(s.target.value)),className:"w-full accent-primary-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Similarity Boost (",V,")"]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:V,onChange:s=>Z(Number(s.target.value)),className:"w-full accent-primary-500"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"secondary",className:"text-xs h-8",onClick:$e,isLoading:js,disabled:!E,children:[e.jsx(rt,{size:14,className:"mr-2"}),"Load Voices"]}),Ve.length>0&&e.jsxs(xe,{value:H,onChange:s=>$(s.target.value),children:[e.jsx("option",{value:"",children:"Select a voice..."}),Ve.map(s=>e.jsx("option",{value:s.voice_id,children:s.name},s.voice_id))]})]}),e.jsx(l,{onClick:Ts,isLoading:fe,disabled:!E,children:"Generate MP3 (ElevenLabs)"}),!E&&e.jsx("p",{className:"text-xs text-yellow-600",children:"TTS disabled. Set `ELEVENLABS_API_KEY` in `server/.env`."})]})}),(d==="all"||d==="voice")&&e.jsx(S,{title:"Voice Clone (Consent Required)",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Clone only voices you own or have explicit permission to use. Provide at least one clear sample file path from your outputs."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(n,{value:ee,onChange:s=>Ns(s.target.value),placeholder:"Clone name (e.g. Segun Narrator)"}),e.jsx(n,{value:W,onChange:s=>se(s.target.value),placeholder:"Sample audio path (e.g. server/outputs/user-audio-xxx.wav)"})]}),e.jsx(n,{value:_e,onChange:s=>Ss(s.target.value),placeholder:"Optional description"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:te,onChange:s=>ws(s.target.checked)}),"I confirm I have rights and consent to clone this voice."]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:ae,onChange:s=>ks(s.target.checked)}),"I will not use this to impersonate or deceive."]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:re,onChange:s=>Cs(s.target.checked)}),"I accept ElevenLabs terms and responsibility for usage."]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:()=>se(h),disabled:!h,children:"Use Current Audio Path"}),e.jsx(l,{onClick:qs,isLoading:bs,disabled:!E,children:"Clone Voice"})]})]})}),(d==="all"||d==="voice")&&e.jsx(S,{title:"Voice Presets",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsx(n,{value:Se,onChange:s=>we(s.target.value),placeholder:"Preset label (e.g. Narrator)"}),e.jsx(n,{value:ke,onChange:s=>Ce(s.target.value),placeholder:"Voice ID (optional)"}),e.jsx(n,{type:"number",value:Re,onChange:s=>Pe(Number(s.target.value)),step:.05,min:0,max:1,placeholder:"Stability"}),e.jsx(n,{type:"number",value:Ae,onChange:s=>Te(Number(s.target.value)),step:.05,min:0,max:1,placeholder:"Similarity"})]}),e.jsxs(l,{onClick:$s,className:"text-xs h-8",children:[e.jsx(it,{size:14,className:"mr-2"}),"Save Preset"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Quick add multiple IDs: one per line. Format: ",e.jsx("code",{children:"Label|voiceId"})," or just ",e.jsx("code",{children:"voiceId"}),"."]}),e.jsx(ds,{value:Ie,onChange:s=>Le(s.target.value),placeholder:"Narrator|xxxxxxxx\\nSermon|yyyyyyyy\\nzzzzzzzz"}),e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:Fs,children:"Add IDs"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:C.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-800",children:s.label}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["Voice ID: ",s.voiceId||"not set"]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["Stability ",s.stability," â€¢ Similarity ",s.similarity]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:()=>Hs(s),children:"Use"}),e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:()=>Bs(s.id),children:e.jsx(ot,{size:14})})]})]},s.id))})]})}),(d==="all"||d==="record")&&e.jsx(S,{title:"2. Record / Upload",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Record directly in the browser or upload an audio file. The result is saved to outputs and becomes selectable across Render and Timeline."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[ye?e.jsx(l,{onClick:Us,variant:"danger",className:"text-xs h-9",children:"Stop Recording"}):e.jsxs(l,{onClick:_s,className:"text-xs h-9",children:[e.jsx(tt,{size:14,className:"mr-2"}),"Start Recording"]}),e.jsxs("label",{className:"text-xs h-9 px-4 rounded-lg font-medium transition-all duration-200 bg-gray-200 text-gray-800 hover:bg-gray-300 flex items-center gap-2 cursor-pointer",children:[e.jsx(xt,{size:14}),"Upload Audio",e.jsx("input",{type:"file",accept:"audio/*,.mp3,.wav,.webm,.m4a,.aac,.ogg,.flac",className:"hidden",onChange:s=>{const t=s.target.files?.[0];t&&Ls(t)},disabled:ps})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest mb-2",children:"Live Input"}),e.jsx("canvas",{ref:De,width:520,height:80,className:"w-full rounded-lg border border-white/10 bg-black/30"})]}),O&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest",children:"Latest Recording/Upload"}),e.jsx("audio",{controls:!0,src:O,className:"w-full"}),e.jsx("p",{className:"text-[10px] text-gray-500 break-all",children:h})]}),Ne&&e.jsx("p",{className:"text-[10px] text-gray-500 break-all",children:Ne})]})}),(d==="all"||d==="treatment")&&e.jsxs(S,{title:"3. Audio Treatment",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Choose a preset, then tweak controls. Click ",e.jsx("strong",{children:"Process Audio"})," to generate a cleaned MP3 and auto-fill Audio Path."]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>gs(s=>!s),className:"flex items-center gap-2 text-xs text-primary-600",children:[je?e.jsx(ms,{size:14}):e.jsx(us,{size:14}),"Audio Treatment Guide"]}),je&&e.jsxs("div",{className:"mt-3 text-xs text-gray-600 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Preset:"})," quick starting point. Use Clean Voice for most narration."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Denoise:"})," reduces background noise. 0.2 to 0.6 is typical."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Gate (dB):"})," mutes low-level noise between phrases. More negative = gentler."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Highpass:"})," removes rumble (60 to 120Hz for voice)."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lowpass:"})," removes hiss (10 to 14kHz for voice)."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Comp Ratio/Threshold:"})," smooths peaks. Higher ratio = tighter dynamics."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"LUFS:"})," loudness target. -16 is good for social; -14 is punchier."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Remove Silence:"})," trims leading silence only (safe mode)."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"De-esser:"})," reduces harsh s sounds (0.3 to 0.7 typical)."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Limiter:"})," catches peaks to avoid clipping (ceiling around -1dB)."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Presence Boost:"})," adds clarity around 3 to 5kHz if voice sounds dull."]}),e.jsx("p",{className:"text-[10px] text-gray-500",children:"Pro effects we can add next: multiband EQ, expander, saturation, room removal, and breath control."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preset"}),e.jsxs(xe,{value:U,onChange:s=>hs(s.target.value),children:[e.jsx("option",{value:"clean_voice",children:"Clean voice (recommended)"}),e.jsx("option",{value:"podcast",children:"Podcast (louder)"}),e.jsx("option",{value:"warm",children:"Warm (softer)"}),e.jsx("option",{value:"raw",children:"Raw (no processing)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Denoise (0-1)"}),e.jsx(n,{type:"number",value:Be,onChange:s=>Fe(Number(s.target.value)),step:.05,min:0,max:1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Gate (dB)"}),e.jsx(n,{type:"number",value:qe,onChange:s=>Ge(Number(s.target.value)),step:1,min:-70,max:-10})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Highpass (Hz)"}),e.jsx(n,{type:"number",value:Qe,onChange:s=>We(Number(s.target.value)),step:10,min:0,max:300})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Lowpass (Hz)"}),e.jsx(n,{type:"number",value:Oe,onChange:s=>Ye(Number(s.target.value)),step:500,min:2e3,max:2e4})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Comp Ratio"}),e.jsx(n,{type:"number",value:Ke,onChange:s=>Je(Number(s.target.value)),step:.2,min:1,max:10})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Comp Threshold (dB)"}),e.jsx(n,{type:"number",value:Xe,onChange:s=>Ze(Number(s.target.value)),step:1,min:-40,max:-5})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"LUFS Target"}),e.jsx(n,{type:"number",value:es,onChange:s=>ss(Number(s.target.value)),step:1,min:-23,max:-10})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Remove Silence"}),e.jsxs(xe,{value:ts?"true":"false",onChange:s=>as(s.target.value==="true"),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]})]})]}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("button",{onClick:()=>vs(s=>!s),className:"text-xs text-primary-600 flex items-center gap-2",children:[M?e.jsx(ms,{size:14}):e.jsx(us,{size:14}),"Advanced Effects"]}),M&&e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"De-esser (0-1)"}),e.jsx(n,{type:"number",value:le,onChange:s=>Ws(Number(s.target.value)),step:.05,min:0,max:1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Limiter Ceiling (dB)"}),e.jsx(n,{type:"number",value:de,onChange:s=>Os(Number(s.target.value)),step:.5,min:-6,max:0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Presence Boost (dB)"}),e.jsx(n,{type:"number",value:ue,onChange:s=>Ys(Number(s.target.value)),step:.5,min:0,max:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Presence Freq (Hz)"}),e.jsx(n,{type:"number",value:rs,onChange:s=>Ks(Number(s.target.value)),step:100,min:2e3,max:8e3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Presence Q"}),e.jsx(n,{type:"number",value:is,onChange:s=>Js(Number(s.target.value)),step:.1,min:.5,max:3})]})]})]}),e.jsx(l,{onClick:Is,isLoading:fe,children:"Process Audio"})]})]}),(d==="all"||d==="treatment")&&e.jsxs(S,{title:"Current Audio",children:[e.jsx(n,{value:h,onChange:s=>I(s.target.value),placeholder:"e.g. server/outputs/audio.mp3"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This path will be used in the Render and Timeline pages."}),O&&e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsx("audio",{controls:!0,src:O,className:"w-full"}),e.jsxs(l,{variant:"secondary",onClick:()=>{navigator.clipboard.writeText(h),i.success("Audio path copied")},className:"text-xs h-9",children:[e.jsx(pe,{size:14,className:"mr-2"}),"Copy"]})]})]}),(d==="all"||d==="treatment")&&e.jsx(S,{title:"Recent Audio (Saved)",children:D.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No processed or uploaded audio yet."}):e.jsxs("div",{className:"space-y-3",children:[(be?D:D.slice(0,6)).map(s=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-600 uppercase tracking-wider",children:s.kind}),e.jsx("p",{className:"text-sm font-mono text-gray-800 break-all",children:s.path}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:new Date(s.createdAt).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"secondary",className:"text-xs h-8",onClick:()=>I(s.path),children:[e.jsx(ct,{size:14,className:"mr-2"}),"Use"]}),e.jsxs(l,{variant:"secondary",className:"text-xs h-8",onClick:()=>{navigator.clipboard.writeText(s.path),i.success("Copied")},children:[e.jsx(pe,{size:14,className:"mr-2"}),"Copy"]})]}),e.jsx("audio",{controls:!0,src:he(s.path,b.baseUrl),className:"w-full md:w-64"})]},s.id)),D.length>6&&e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:()=>fs(s=>!s),children:be?"Collapse list":`Show all (${D.length})`})]})}),(d==="all"||d==="soundtrack")&&e.jsx(S,{title:"Soundtrack Library",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(l,{variant:"secondary",className:"text-xs h-8",onClick:Gs,isLoading:As,children:[e.jsx(nt,{size:14,className:"mr-2"}),"Load Music Library"]}),e.jsx("span",{className:"text-[10px] text-gray-500",children:"Use any audio file from outputs as a soundtrack for Render."})]}),ie.length>0?e.jsxs("div",{className:"space-y-3",children:[ie.slice(0,20).map(s=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-600 uppercase tracking-wider",children:s.name||"Audio"}),e.jsx("p",{className:"text-xs font-mono text-gray-800 break-all",children:s.path}),s.mtime&&e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:new Date(s.mtime).toLocaleString()})]}),e.jsx("audio",{controls:!0,src:he(s.path,b.baseUrl),className:"w-full md:w-64"}),e.jsx(l,{variant:"secondary",className:"text-xs h-8",onClick:()=>Qs(s.path),children:"Use in Render"})]},s.path||s.name)),ie.length>20&&e.jsx("p",{className:"text-[10px] text-gray-500",children:"Showing latest 20 items."})]}):e.jsx("p",{className:"text-sm text-gray-500",children:"No audio files found. Upload or process audio first."})]})})]})]})}export{kt as VoiceAudioPage};
